"use strict";function getCookie(e){e=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}function setCookie(e,t,r={}){(r={path:"/",...r}).expires instanceof Date&&(r.expires=r.expires.toUTCString());let a=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var c in r){a+="; "+c;c=r[c];!0!==c&&(a+="="+c)}document.cookie=a}function deleteCookie(e){setCookie(e,"",{"max-age":-1})}function endingWord(e,t){return e[4<t%100&&t%100<20?2:[2,0,1,1,1,2][t%10<5?Math.abs(t)%10:5]]}document.addEventListener("DOMContentLoaded",function(){function e(e,r){e.forEach(e=>{var t=e.querySelector(".navigation");r.navigation.prevEl=t.querySelector(".btn-prev"),r.navigation.nextEl=t.querySelector(".btn-next"),new Swiper(e,r)})}new Swiper(".main-slider",{loop:!0,effect:"fade",autoplay:{delay:5e3,disableOnInteraction:!1},navigation:{nextEl:".main-slider .button-next",prevEl:".main-slider .button-prev"}}),new Swiper(".main-slider-mobile",{loop:!0,effect:"fade",autoplay:{delay:5e3,disableOnInteraction:!1},pagination:{el:document.querySelector(".main-slider-mobile-pagination")}}),o={autoplay:{delay:2500,disableOnInteraction:!1},navigation:{nextEl:null,prevEl:null}},l=document.querySelectorAll(".block-product-slider__grid"),s=document.querySelectorAll(".block-product-slider__list"),l&&((t=o).breakpoints={0:{slidesPerView:2.2,spaceBetween:10},768:{slidesPerView:4,spaceBetween:20},991:{slidesPerView:5,spaceBetween:20},1200:{slidesPerView:6,spaceBetween:20}},e(l,t)),s&&((l=o).breakpoints={0:{slidesPerView:1,spaceBetween:10},768:{slidesPerView:2,spaceBetween:20},991:{slidesPerView:3,spaceBetween:20},1200:{slidesPerView:3,spaceBetween:20}},e(s,l));var t=new Swiper(".catalog-product-slider .mySwiper",{breakpoints:{0:{slidesPerView:3,spaceBetween:5},768:{slidesPerView:3,spaceBetween:20},991:{slidesPerView:4,spaceBetween:10}}});new Swiper(".catalog-product-slider .mySwiper2",{loop:!0,navigation:{nextEl:".button-next",prevEl:".button-prev"},thumbs:{swiper:t}});{function a(){document.body.classList.toggle("no-scroll"),e.classList.toggle("active"),n()}function c(){(t=this.nextElementSibling)&&(t.classList.add("active"),t.querySelectorAll(".category-level-2").forEach(e=>{e.addEventListener("click",i)}))}function i(){r.push(this),r&&this.classList.toggle("active")}function n(){t&&(t.classList.remove("active"),t=null),r&&(r.forEach(e=>{e.classList.remove("active")}),r.length=0)}var o=document.querySelectorAll(".btn-catalog-menu-mobile");let e=document.querySelector(".mobile-menu-catalog");var s=e.querySelectorAll(".main-category_wrapper");let t=null,r=[];var l=e.querySelectorAll(".link-back");o.forEach(e=>{e.addEventListener("click",a)}),s.forEach(e=>{e.addEventListener("click",c)}),l.forEach(e=>{e.addEventListener("click",n)})}{let e=document.querySelector("header").querySelector("nav"),t=document.querySelector(".btn-mobile-nav");t.addEventListener("click",function(){document.body.classList.toggle("no-scroll"),e.classList.toggle("active"),t.classList.toggle("active")})}(o=document.querySelector(".cart-wrapper"))&&(s=o.querySelectorAll(".btn-quantity-cart"),o=o.querySelectorAll(".quantity-num"),s.forEach(function(r){r.addEventListener("click",function(){var e,t=r.parentElement.querySelector(".quantity-num");(r.classList.contains("btn-quantity-minus")||t.value<t.getAttribute("max"))&&(r.classList.contains("btn-quantity-minus")?1<(e=t).value&&(e.value=+e.value-1):t.value=+t.value+1,$("#cart-form").sendForm("onUpdateQuantity",{}))})}),o.forEach(function(e){e.addEventListener("change",function(){e.value=1<=e.value?e.value:1,$("#cart-form").sendForm("onUpdateQuantity",{})})}));{let a=document.querySelector(".cart-wrapper");function r(t){var r=a.querySelector(".devivery-price").querySelector("span"),e=t.getAttribute("data-price"),t=t.getAttribute("data-code");if(0==e){let e=null;switch(t){case"pickup":e="Самовывоз";break;case"tk":e="Бесплатно до ТК";break;default:e="Бесплатно"}r.textContent=e}else r.textContent=e}function d(e){var t=a.querySelector(".total-price").querySelector("span"),r=a.querySelector(".goods-price").querySelector("span");t.textContent=Number(e.getAttribute("data-price"))+Number(r.getAttribute("data-summ"))}function u(e){var t=a.querySelector(".section-address");"pickup"==e.getAttribute("data-code")||t.classList.contains("active")?"pickup"==e.getAttribute("data-code")&&t.classList.remove("active"):t.classList.add("active")}a&&a.querySelectorAll('input[name="delivery"]').forEach(function(e){e.hasAttribute("checked")&&(r(e),d(e),u(e)),e.addEventListener("change",function(){r(e),d(e),u(e)})})}l=document.querySelector(".catalog-products-sorting .view-mode");if(l){getCookie("viewModeProductsList")||setCookie("viewModeProductsList","grid");let t=l.querySelectorAll(".item"),r=getCookie("viewModeProductsList");t.forEach(function(e){e.addEventListener("click",function(){r="grid"==this.getAttribute("data-type")||"list"==this.getAttribute("data-type")?this.getAttribute("data-type"):"grid",document.querySelector(".wrapper-products--default").setAttribute("data-view-list",r),setCookie("viewModeProductsList",r),t.forEach(function(e){e.classList.remove("active")}),e.classList.add("active")})})}function p(){var e="product"==location.pathname.split("/")[2]?"product":"catalog",t=document.querySelectorAll(".btn-buy");let c=[],i=("product"==e?(e=document.querySelector(".catalog-product"),c.push(e)):c=document.querySelectorAll(".product-card"),{headers:{"UFO-AJAX-HANDLER":"ev{onAddToCart}","UFO-REQUEST":1}}),n=document.getElementById("mini-cart"),o=document.getElementById("mini-cart-mobile");t&&c&&t.forEach(e=>{e.addEventListener("click",function(){let r=this.getAttribute("data-id"),e=this.getAttribute("data-type"),t=this.getAttribute("data-quantity"),a=this.getAttribute("data-id-sku");axios.post("/shop/",{id:r,type:e,quantity:t,id_sku:a},i).then(e=>{var t=e.data.response["#mini-cart"],e=e.data.response["#mini-cart-mobile"];console.log(t),t&&e&&(n.innerHTML=t,o.innerHTML=e,c.forEach(e=>{e.getAttribute("data-id")==r&&e.classList.add("added")}))})})})}p();{function v(){0<window.pageYOffset&&window.scrollBy(0,-window.pageYOffset)}window.addEventListener("scroll",function(){var e=window.pageYOffset;document.documentElement.clientHeight<e?t.forEach(e=>e.classList.add("active")):t.forEach(e=>e.classList.remove("active"))});let t=document.querySelectorAll(".btn-up-page");t.forEach(e=>e.addEventListener("click",v))}{let c=document.querySelector(".catalog-product");c&&(s=c.querySelectorAll("input[name='product-sku']"))&&s.forEach(e=>e.addEventListener("change",e=>{var t,r,a,e=e.target;r=e,t=c.querySelector(".add-to-cart-btn"),r=r.value,(a=JSON.parse(t.getAttribute("data-extra"))).id_sku=r,t.setAttribute("data-extra",JSON.stringify(a)),r=(r=e).getAttribute("data-price"),c.querySelector(".catalog-product_buy-price .actual").textContent=r,t=e,r=(a=c.querySelector(".product-other-info")).querySelector(".product-amount"),a=a.querySelector(".product-code_sku"),e=t.getAttribute("data-leftover"),t=t.value,r.querySelector("span").textContent=e,a.textContent=t}))}{let t=document.querySelector(".catalog-product_description-hidden");if(t){let e=t.querySelector(".btn-more");e.addEventListener("click",function(){t.classList.toggle("active"),e.textContent=t.classList.contains("active")?"Свернуть":"Показать всё"})}}o=document.querySelector(".infinity-products-list");if(o){l=o.querySelector(".btn-more-products");let r=o.querySelector(".wrapper-products"),e={headers:{"UFO-AJAX-HANDLER":"ev{onGetRandomProducts}","UFO-REQUEST":1}};o=r.querySelectorAll(".product-card");let a=[];o&&o.forEach(e=>a.push(e.getAttribute("data-id"))),l.addEventListener("click",()=>{axios.post("/",{ids:a},e).then(e=>{var t;e.data.response&&(t=e.data.response.newProductsIds,e=e.data.response.newProducts,r.insertAdjacentHTML("beforeend",e),t.forEach(e=>a.push(e)),p())})})}}),document.addEventListener("DOMContentLoaded",function(){let a="search-history",e=document.querySelector(".widget-search"),t=e.querySelector(".search-input"),r=e.querySelectorAll(".btn-search"),c=e.querySelector(".widget-search-results"),i=c.querySelector(".widget-search-results_categories"),n=i.querySelector(".widget-search-results_categories-list"),o=c.querySelector(".widget-search-results_products"),s=o.querySelector(".widget-search-results_products-list"),l=c.querySelector(".widget-search-results_history"),d=l.querySelector(".widget-search-results_history-list"),u=c.querySelector(".widget-search-results_all"),p=u.querySelector(".all-results_categories"),v=u.querySelector(".all-results_products");function g(){let e=t.value;return e=e.replaceAll(/<[^>]+>/gi,"")}let m=e.querySelector(".btn-clear"),y=!1;function h(){u.classList.remove("active"),p.classList.remove("active"),v.classList.remove("active"),p.querySelector("span").textContent="",v.querySelector("span").textContent=""}function f(){t.value="",i.classList.contains("active")&&(i.classList.remove("active"),n.innerHTML=""),o.classList.contains("active")&&(o.classList.remove("active"),s.innerHTML=""),h(),q(),S()}function S(){y=!y,m.classList.toggle("active")}function L(){axios.post("/search/widget/",{query:g()}).then(e=>{e=e.data.response;if(e&&e.categories.length){var c=e.categories;let t="",r=["товар","товара","товаров"],a=0;c.forEach(e=>{0<e.products_count&&(t+=`<div data-href='/catalog/${e.id}'><span data-level="${e.level}">${e.name}</span> <span data-level="${e.parent_level}">${e.parent_name}</span> <span>${e.products_count} ${endingWord(r,14)}</span></div>`),++a==c.length&&t.length&&(n.innerHTML=t,i.classList.add("active"))})}else n.innerHTML="",i.classList.remove("active");if(e&&e.products.length){var a=e.products;let t="",r=0;a.forEach(e=>{t+=`<div data-href='/catalog/product/${e.id}'><img src="${e.image}"><span>${e.name}</span></div>`,++r==a.length&&t.length&&(s.innerHTML=t,o.classList.add("active"))})}else s.innerHTML="",o.classList.remove("active");h(),e&&(t=e.count_categories,e=e.count_products,t&&(p.querySelector("span").textContent=t,p.classList.add("active")),e&&(v.querySelector("span").textContent=e,v.classList.add("active")),t||e)&&u.classList.add("active"),l.classList.remove("active");var t=n.querySelectorAll("div"),e=s.querySelectorAll("div");(t=[...t,...e]).forEach(t=>{t.addEventListener("click",()=>{var e=t.getAttribute("data-href");b({name:t.querySelector("span").textContent,href:e})})})})}function q(){let t=E(),r="",a=0;t&&t.length&&t.forEach(e=>{r+=`<div><a href="${e.href}">${e.name}</a></div>`,++a==t.length&&r.length&&(d.innerHTML=r,l.classList.add("active"))})}m.addEventListener("click",()=>f()),q(),t.addEventListener("click",()=>{c.classList.contains("active")||c.classList.add("active")}),window.addEventListener("click",e=>{c.classList.contains("active")&&"widget-search"!=e.target.className&&!e.target.closest(".widget-search")&&c.classList.remove("active")});let w=null;function E(){return JSON.parse(localStorage.getItem(a))}function b(r){var e=E();if(e&&e.length){let t=!0;e.forEach(e=>{e.href==r.href&&(t=!1)}),3==e.length&&e.splice(0,1),t&&localStorage.setItem(a,JSON.stringify([...e,r]))}else localStorage.setItem(a,JSON.stringify([r]));window.location=r.href}var A;t.addEventListener("input",function(){0<this.value.length?(w&&clearTimeout(w),w=setTimeout(L,1e3)):f(),0<this.value.length&&!y&&S()}),t.addEventListener("keypress",function(e){var t;"Enter"===e.key&&(t="/search/?q="+g().replace(" ","+"),b({name:g(),href:t}),e.preventDefault(),r.forEach(e=>e.click()))}),r.forEach(e=>e.addEventListener("click",()=>window.location="/search?q="+g())),l.querySelector(".widget-search-results_history-btn-clear").addEventListener("click",()=>{E()&&(l.classList.remove("active"),localStorage.removeItem(a))}),(A=document.querySelectorAll(".btn-status-search"))&&A.forEach(e=>{e.addEventListener("click",()=>document.body.classList.toggle("search-active"))})});