<?php if (isset($category) && $category): ?>

	<?php $subCategories = $category->list_children() ?>

	<div class="container <?= $subCategories ? 'catalog-categories': 'catalog-products'?>">
		<?php $this->renderPartial('breadcrumbs') ?>

		<?php if(count($subCategories)): ?>

			<?/* --- КАТЕГОРИИ --- */?>

			<div class="catalog-categories-title"><?= $category->name; ?></div>

			<div class="catalog-categories-list">
				<?php
					foreach ($subCategories as $subCategory){
						$typeItem = count($subCategory->list_children()) ? 'multi': 'single';

						$this->renderPartial($this->getViewsDir() . "/catalog/item_catalog_category_".$typeItem.".htm", ['category'=>$subCategory]);
					}
				?>
			</div>	

		<?php else: ?>

			<?/* --- ТОВАРЫ --- */?>

			<div class="heading-page">
				<h1><?= $category->name?></h1>
			</div>

			<div class="catalog-products_wrapper">

				<?php $this->renderPartial('filters') ?>

				<div class="catalog-products_list">
					<?php 
						$viewModeProductsList = isset($_COOKIE['viewModeProductsList']) ? $_COOKIE['viewModeProductsList'] : "grid";

						$this->renderPartial('sorting', ['viewModeProductsList'=>$viewModeProductsList]);
					?>

					<div class="list-products lg-4 md-3 sm-2" data-view-list='<?= $viewModeProductsList ?>'>
						<?php if (isset($products) && $products->count): ?>
							<?php foreach ($products as $product): ?>
								<?php $this->renderPartial("product_card", ['product'=>$product]);?>
							<?php endforeach; ?>
						<?php else: ?>
							<p>В данной категории товаров нет</p>
						<?php endif; ?>
					</div>			
				</div>
			</div>
		<?php endif;?>		
	</div>
<?php else: ?>
	<h2>Категория не найдена</h2>
<?php endif; ?>
		
	
		

<?php /** @var $pagination Phpr_Pagination*/ ?>
<?/*
<?php if (isset($pagination)): ?>
	<?= $pagination->format(new Phpr_PrimePaginationFormatter(), u("catalog_category", [$category->id]) . "%d/") ?>
<?php endif; ?>
*/?>
	



